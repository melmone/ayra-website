<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商品1詳細</title>
    <script type="module" src="js/firebase-init.js"></script>
    <script type="module" src="js/product-soldout.js" defer></script>
    
    <link rel="stylesheet" href="stylesheet.css"> <!-- CSSファイルを適用 -->
</head>

<body>
    <div class="wrapper">
        <div class="header">
            <a href="index.html" class="header-logo">
                <img src="images/Ayraロゴ.jpg" alt="冠付きロゴ">
            </a>
            
            
            <div class="hamburger-menu">
                ☰
            </div>
            
            <ul class="nav-list">
                <li><a href="about.html">About</a></li>
                <li><a href="onlineshop.html">Online shop</a></li>
                <li><a href="custom.html">Custom</a></li>
                <li><a href="news.html">News</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>

            <div class="cart-icon-wrapper">
                <a href="cart.html">
                  <img src="images/cart.png" alt="カート" class="cart-icon">
                  <span class="cart-count" id="cart-count">0</span>
                </a>
              </div>
        </div>
    </div>

    <header class="ring-category">
        
        <nav class="category">
            <a href="onlineshop.html">Online shop</a> |
            <a href="ring3.html">トリーニ</a> |
            <a href="ring2.html">ドゥヴェ</a> |
            <a href="ring5.html">ヴァーティカル</a> |
            <a href="ring6.html">スクリュー</a> |
            <a href="ring4.html">SPECIAL PRICE</a> |
            <a href="ring1.html">エーカム</a> 
        </nav>
    </header>

    <div class="product-detail">
       
        <div class="product-images">
            <div class="main-image-wrapper">
                <img id="main-image" src="images/ルチル.オニキス.クリスタル横.jpg" alt="商品1横から">
                <div class="sold-out-label2">SOLD OUT</div>
            </div>
            
            <div class="thumbnail-container">
                <img class="thumbnail" src="images/ルチル.オニキス.クリスタル正面.jpg" alt="商品1正面" onclick="swapImages(this)">
                <img class="thumbnail" src="images/黒ルチル.オニキス.クリスタルイメージ.JPG" alt="商品1の別角度" onclick="swapImages(this)">
            </div>
        </div>
       
        <div class="product-info" id="product-info" data-product-id="C020-10-1">
            <h1 class="product-title">ブラックルチルクォーツ/オニキス/クリスタルクォーツ 10-12号</h1>
            <p><strong>素材:</strong><span class="product-material">ブラックルチルクォーツ/オニキス/クリスタルクォーツ</span></p>
            <p><strong>ベース:</strong><span class="product-base">Brass, 18K gold plated</span> (詳しくは<a href="faqs.html">こちら</a>)</p>
            <p><strong>価格:</strong><span class="product-price">¥22,000(税込)</span></p>
            <p><strong>サイズ:</strong><span class="product-size">10-12号</span></p>
            <p><strong>商品番号:</strong><span class="product-sku">C020-10-1</span></p>

            <div class="tags">
                
                <a href="tag.html?tag=ブラックルチルクォーツ" class="tag">ブラックルチルクォーツ</a>
                <a href="tag.html?tag=オニキス" class="tag">オニキス</a>
                <a href="tag.html?tag=クリスタルクォーツ" class="tag">クリスタルクォーツ</a>
                <a href="tag.html?tag=青" class="tag">黒</a>
                <a href="tag.html?tag=緑" class="tag">透明</a>
                <a href="tag.html?tag=10号" class="tag">10号</a>
                <a href="tag.html?tag=11号" class="tag">11号</a>
                <a href="tag.html?tag=12号" class="tag">12号</a>
            </div>
            <button class="buy-button">カートに入れる</button>
        </div>

    </div>

    <div class="related-products-container">
        <h2>Related items</h2>
        <div id="related-products">
            <div id="related-items" class="product-grid"></div>
        </div>
        
    </div>

    <div class="footer">
        <a href="https://www.instagram.com/ayra_rings" target="_blank">
            <img src="images/図1.png" alt="Instagram" class="instagram-icon">
        </a>
        <ul class="nav-list2">
            <li><a href="about.html">About</a></li>
        <li><a href="onlineshop.html">Online shop</a></li>
        <li><a href="custom.html">Custom</a></li>
        <li><a href="news.html">News</a></li>
        <li><a href="contact.html">Contact</a></li>
        </ul>

        
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
          const hamburger = document.querySelector(".hamburger-menu");
          const navList = document.querySelector(".nav-list");
      
          hamburger.addEventListener("click", function () {
            navList.classList.toggle("active");
          });
        });
      </script>
 

    <script>
        
        // 商品データ（実際はサーバーやデータベースで管理）
        const products = [
        { 
            name: "クリスタルクォーツ 10号",
            price: "¥4,500",
            tags: ["クリスタルクォーツ", "楕円形", "透明", "10号"],                 
            img: "images/クリスタルクォーツ楕円横.jpg",
            url: "ring1-1.html"
        },
        { 
            name: "クリスタルクォーツ 9号", 
            price: "¥4,000",
            tags: ["クリスタルクォーツ", "丸形", "9号"], 
            img: "images/クリスタルクォーツ丸横.jpg",
            url: "ring1-2.html" 
        },
        { 
            name: "クリスタルクォーツ 10号", 
            price: "¥4,000",
            tags: ["クリスタルクォーツ", "丸形", "10号"], 
            img: "images/クリスタル丸横.jpg",
            url: "ring1-2-2.html" 
        },
        
        { 
            name: "クリスタルクォーツ 11号",
            price: "¥5,500", 
            tags: ["クリスタルクォーツ", "多角形", "透明", "11号"], 
            img: "images/クリスタル五角形横.jpg",
            url: "ring1-3.html"
        },
        { 
            name: "クリスタルクォーツ 10号",
            price: "¥5,500", 
            tags: ["クリスタルクォーツ", "多角形", "透明", "10号"], 
            img: "images/クリスタル五角形10号横.jpg",
            url: "ring1-3-2.html"
        },
        { 
            name: "ローズクォーツ 11号",
            price: "¥3,000", 
            tags: ["ローズクォーツ", "長方形", "11号"], 
            img: "images/ローズクォーツ長方形横.jpg",
            url: "ring1-4.html"
        },
        { 
            name: "スマイル ピンク 14号",
            price: "¥3,500",
            tags: ["エナメル", "ピンク", "14号"],
            img: "images/ピンクスマイル横.jpg",
            url: "ring1-5.html"
        },
        { 
            name: "カーネリアン 11号",
            price: "¥3,500",
            tags: ["カーネリアン", "雫形", "オレンジ", "11号"],
            img: "images/カーネリアン横.jpg",
            url: "ring1-6.html"
        },
        { 
            name: "グリーンアメジスト 9号",
            price: "¥8,000",
            tags: ["グリーンアメジスト", "長方形", "緑", "9号"],
            img: "images/緑アメジスト横.jpg",
            url: "ring1-7.html" 
        },
        { 
            name: "アメジスト 12号",
            price: "¥6,000", 
            tags: ["アメジスト", "楕円形", "紫", "12号"], 
            img: "images/アメジスト楕円横.jpg",
            url: "ring1-8.html"
        },
        { 
            name: "カルセドニー 10号",
            price: "¥3,000", 
            tags: ["カルセドニー", "丸形", "水色", "カボション", "10号"], 
            img: "images/カルセドニー横.jpg",
            url: "ring1-9.html" 
        },
        { 
            name: "モナリザピンク 9号",
            price: "¥3,500", 
            tags: ["モナリザピンク", "丸形", "ピンク", "カボション", "9号"],
            img: "images/ピンクモナリザ9号横.jpg",
            url: "ring1-10.html" 
        },
        { 
            name: "モナリザピンク 10号",
            price: "¥3,500", 
            tags: ["モナリザピンク", "丸形", "ピンク", "カボション", "10号"],
            img: "images/モナリザピンク10号横.jpg",
            url: "ring1-10-2.html" 
        },
        
        { 
            name: "ローズクォーツ/クリスタルクォーツ 12-14号",
            price: "¥6,000", 
            tags: ["ローズクォーツ", "クリスタルクォーツ", "透明", "12号", "13号", "14号"], 
            img: "images/クリスタル.ローズ横.jpg",
            url: "ring2-1.html" 
        },
        { 
            name: "カイヤナイト/アメジスト 12号-14号",
            price: "¥8,000", 
            tags: ["カイヤナイト", "アメジスト", "青", "紫", "12号", "13号", "14号"], 
            img: "images/カイヤナイト.アメジスト横.jpg",
            url: "ring2-2.html" 
        },
        { 
            name: "カーネリアン/シトリン 10-11号",
            price: "¥6,000", 
            tags: ["カーネリアン", "シトリン", "オレンジ", "10号", "11号"], 
            img: "images/カーネリアン.シトリン横.jpg",
            url: "ring2-3.html" 
        },
        { 
            name: "ラリマー/カイヤナイト/タンザナイト 8-10 号",
            price: "¥8,000", 
            tags: ["ラリマー", "カイヤナイト", "タンザナイト", "青", "8号", "9号", "10号"], 
            img: "images/ラリマー.カイヤナイト.タンザナイト.jpg",
            url: "ring3-1.html" 
        },
        { 
            name: "グリーンハイドロクォーツ/ラリマー/フローライト 12-14号",
            price: "¥20,000", 
            tags: ["グリーンハイドロクォーツ", "ラリマー", "フローライト", "緑", "12号", "13号", "14号"], 
            img: "images/緑ハイド.ラリマー.フローライト.jpg",
            url: "ring3-2.html" 
        },
        { 
            name: "グリーンカイヤナイト/フローライト/シトリン 11-12号",
            price: "¥10,000", 
            tags: ["グリーンカイヤナイト", "カイヤナイト", "フローライト", "シトリン", "11号", "12号"], 
            img: "images/グリーンカイヤナイト.フローライト.シトリン.jpg",
            url: "ring3-3.html" 
        },
        { 
            name: "クリスタルクォーツ/ブルードゥルージー/ホワイトドゥルージー 10-12号",
            price: "¥8,000", 
            tags: ["クリスタルクォーツ", "ブルードゥルージー", "ホワイトドゥルージー", "透明", "白", "青", "10号", "11号", "12号"], 
            img: "images/クリスタル.ドゥルージー.ドゥルージー横.jpg",
            url: "ring3-4.html" 
        },
        { 
            name: "カイヤナイト/グリーンカイヤナイト/ハーキマーダイヤモンド 9-10号",
            price: "¥10,000", 
            tags: ["カイヤナイト", "グリーンカイヤナイト", "ハーキマーダイヤモンド", "青", "9号", "10号"], 
            img: "images/カイヤ.緑カイヤ.ハーキマー9-10号横.jpg",
            url: "ring3-5.html" 
        },
        { 
            name: "カイヤナイト/グリーンカイヤナイト/ハーキマーダイヤモンド 10-12号",
            price: "¥10,000", 
            tags: ["カイヤナイト", "グリーンカイヤナイト", "ハーキマーダイヤモンド", "青", "10号", "11号", "12号"], 
            img: "images/カイヤ.緑カイヤ.ハーキマー.10-12号横.jpg",
            url: "ring3-5-2.html" 
        },
        { 
            name: "ローズクォーツ/アクアマリン/シトリン 8-10号",
            price: "¥20,000", 
            tags: ["ローズクォーツ", "アクアマリン", "シトリン", "8号", "9号", "10号"], 
            img: "images/ローズクォーツ.アクアマリン.シトリン8-10号横.jpg",
            url: "ring3-6.html" 
        },
        { 
            name: "ローズクォーツ/アクアマリン/シトリン 11-13号",
            price: "¥20,000", 
            tags: ["ローズクォーツ", "アクアマリン", "シトリン", "11号", "12号", "13号"], 
            img: "images/ローズ.アクア.シトリン12号横.jpg",
            url: "ring3-6-2.html" 
        },
        { 
            name: "フローライト/アメジスト/シトリン 9-10号",
            price: "¥10,000", 
            tags: ["フローライト", "アメジスト", "シトリン", "9号", "10号"], 
            img: "images/フローライト.アメジスト.シトリン横.jpg",
            url: "ring3-7.html" 
        },
        { 
            name: "ローズクォーツ/ガーネット/アメジスト 8-10号",
            price: "¥10,000", 
            tags: ["ローズクォーツ", "ガーネット", "アメジスト", "紫", "8号", "9号", "10号"], 
            img: "images/ローズクォーツ.ガーネット.アメジスト.jpg",
            url: "ring3-8.html" 
        },
        { 
            name: "グリーンカイヤナイト/クリスタルクォーツ/アパタイト 10-14号",
            price: "¥10,000", 
            tags: ["グリーンカイヤナイト", "カイヤナイト", "クリスタルクォーツ", "アパタイト", "青", "10号", "11号", "12号", "13号", "14号"], 
            img: "images/緑カイヤナイト.クリスタルクォーツ.アパタイト.jpg",
            url: "ring3-9.html" 
        },
        { 
            name: "カイヤナイト/アメジスト/シトリン 8-10号",
            price: "¥10,000", 
            tags: ["カイヤナイト", "アメジスト", "シトリン", "8号", "9号", "10号"], 
            img: "images/カイヤナイト.アメジスト.シトリン.jpg",
            url: "ring3-10.html" 
        },
        { 
            name: "クリスタルクォーツ/カイヤナイト/タンザナイト 10-11号",
            price: "¥10,000", 
            tags: ["クリスタルクォーツ", "カイヤナイト", "タンザナイト", "青", "紫", "10号", "11号"], 
            img: "images/クリスタル.カイヤナイト.タンザナイト横.jpg",
            url: "ring3-11.html" 
        },
        { 
            name: "カイヤナイト/アパタイト/クリスタルクォーツ 8-9号",
            price: "¥22,000", 
            tags: ["クリスタルクォーツ", "カイヤナイト", "タンザナイト", "青", "紫", "8号", "9号"], 
            img: "images/銀カイヤ.アパタイト.クリスタル横.jpg",
            url: "ring3-12.html" 
        },
        { 
            name: "タンザナイト/アメジスト/ガーネット/ローズクォーツ 8-10号",
            price: "¥10,000", 
            tags: ["タンザナイト", "アメジスト", "ガーネット", "ローズクォーツ", "紫", "8号", "9号", "10号"], 
            img: "images/紫4粒横.jpg",
            url: "ring4-1.html" 
        },
        { 
            name: "アマゾナイト/ソーラークォーツ/シトリン/アゲート 12-14号",
            price: "¥15,000", 
            tags: ["アマゾナイト", "ソーラークォーツ", "シトリン", "アゲート", "青", "水色", "12号", "13号", "14号"], 
            img: "images/水色4粒横.jpg",
            url: "ring4-2.html" 
        },
        { 
            name: "アメジスト 10号",
            price: "¥5,000", 
            tags: ["アメジスト", "紫", "10号"], 
            img: "images/アメジスト縦3横.jpg",
            url: "ring5-1.html" 
        },
        { 
            name: "アクアマリン/アメジスト/シトリン 9号",
            price: "¥5,000", 
            tags: ["アクアマリン", "アメジスト", "シトリン", "9号"], 
            img: "images/アクア.アメジスト.シトリン縦3横.jpg",
            url: "ring5-2.html" 
        },
        { 
            name: "クリスタルクォーツ 9号",
            price: "¥5,800", 
            tags: ["クリスタルクォーツ", "透明", "9号"], 
            img: "images/クリスタルクォーツ縦3横.jpg",
            url: "ring5-3.html" 
        },
        { 
            name: "フローライト 10号",
            price: "¥5,600", 
            tags: ["フローライト", "緑", "10号"], 
            img: "images/フローライト縦3横.jpg",
            url: "ring5-4.html" 
        },
        { 
            name: "ピンクドゥルージー 9号",
            price: "¥6,500", 
            tags: ["ピンクドゥルージー", "ドゥルージー", "ピンク", "9号"], 
            img: "images/ピンクドゥルージー縦横.jpg",
            url: "ring5-.5html" 
        },
        { 
            name: "アクアマリン 8-11号",
            price: "¥5,000", 
            tags: ["アクアマリン", "水色", "8号", "9号", "10号"], 
            img: "images/アクアマリン正面.jpg",
            url: "ring6-1.html"
        },
        { 
            name: "ハーキマーダイヤモンド/クリスタルクォーツ 12-14号",
            price: "¥6,500", 
            tags: ["ハーキマーダイヤモンド", "クリスタルクォーツ", "透明", "12号"], 
            img: "images/ハーキマー.クリスタル横.jpg",
            url: "ring6-2.html" 
        },
        ];
         
        const currentProduct = products.find(p => p.url === "ring3-13.html");
        
        // 関連商品を取得（同じタグを含む）
const relatedProducts = products.filter(p => 
    p !== currentProduct && // 自分自身を除外
    p.tags.some(tag => currentProduct.tags.includes(tag)) // タグが一致する商品を取得
);

console.log("Related items:", relatedProducts);

// 関連商品をHTMLに表示
const relatedContainer = document.getElementById("related-products");
if (relatedProducts.length > 0) {
    relatedProducts.forEach(product => {
        const productElement = document.createElement("div");
        productElement.classList.add("related-product"); // ✅ クラスを追加
        productElement.innerHTML = `
            <a href="${product.url}">
                <img src="${product.img}" alt="${product.name}" width="100">
                <p>${product.name}</p>
                <p>${product.price}</p>
            </a>
        `;
        relatedContainer.appendChild(productElement);
    });
} else {
    relatedContainer.innerHTML = "<p>関連商品がありません</p>";
}


    function swapImages(thumbnail) {
        let mainImage = document.getElementById("main-image");

        // 現在のメイン画像を一時保存
        let tempSrc = mainImage.src;

        // クリックされたサムネイルの画像をメイン画像に設定
        mainImage.src = thumbnail.src;

        // 元のメイン画像をサムネイルに戻す
        thumbnail.src = tempSrc;
    }
    // カートに追加する関数
    document.addEventListener('DOMContentLoaded', function () {
        updateCartCount(); // ← これを最初に実行！

    document.querySelector(".buy-button").addEventListener("click", function () {
        const productInfo = document.getElementById("product-info");
        const product = {
        id: productInfo.dataset.productId,
        title: document.querySelector(".product-title").textContent,  // 商品名
        material: "ブラックルチルクォーツ/オニキス/クリスタルクォーツ 10-12号",  // 素材
        price: 22000,  // 価格
        size: "10-12号",  // サイズ
        quantity: 1,  // 数量
        image: document.getElementById("main-image").src  // 商品画像のURL
    };

    addToCart(product); // ← 自作関数にまとめて呼び出すだけ！

        alert("商品がカートに追加されました！※30分でカートから削除されます");
    });
});

// カートデータをローカルストレージに保存
function addToCart(product) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    const existing = cart.find(item => item.id === product.id);

    if (existing) {
        existing.quantity += 1;
        existing.timestamp = new Date().getTime(); // タイムスタンプ更新
    } else {
    product.timestamp = new Date().getTime(); // 新しい商品にもtimestampを追加
    cart.push(product);
    }

    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
}

    // ★新しい updateCartCount（これだけでOK！）
function updateCartCount() {
    const THIRTY_MINUTES = 30 * 60 * 1000;
    const now = new Date().getTime();

    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // 30分以内の商品だけ残す
    cart = cart.filter(item => !item.timestamp || (now - item.timestamp < THIRTY_MINUTES));

    localStorage.setItem('cart', JSON.stringify(cart));

    const totalQuantity = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
    const countElem = document.getElementById('cart-count');
    countElem.textContent = totalQuantity;
    countElem.style.display = totalQuantity > 0 ? 'inline-block' : 'none';
}

// ページ読み込み時にもチェック
document.addEventListener('DOMContentLoaded', function () {
    updateCartCount(); // ページ読み込み時にまず1回チェックする

    // 5秒ごとにカート内容をチェック・更新（テスト用）
    setInterval(updateCartCount, 5000); 
});

  </script>
  

</body>

</html>

